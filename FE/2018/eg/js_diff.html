<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        *{
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            line-height: 1.1;
        }
        summary:focus{
            outline: none;
        }
        input[type=checkbox]{
            margin-right: 5px;
        }
        #container,#show{
            padding: 20px;
        }
    </style>
</head>
<body>
<div id="container">

</div>
<div id="show"></div>
<script>
    function checkIsObject(obj){
        if(obj === null){
            return false;
        }
        return ({}).toString.call(obj).toLowerCase() == '[object object]';
    }
    class CustomTree{
        constructor(obj,containerDom,showDom,defaultSep='.',root='root'){
            Object.assign(this,{containerDom,showDom,defaultSep,root,detailsArr:[]});
            this.addEvent();
            this.createRoot();
            const lists=this.serailize(obj);
            for(let list of lists){
                this.createTree(list);
            }
        }
        createRoot(){
            const root=this.createDetails(this.root,this.root,true);
            root.style.textIndent='0em';
            this.containerDom.appendChild(root);
            this.containerDom=root;
        }
        serailize(obj,_key='') {
            const keys=Object.keys(obj);
            const arr=[];
            for(let key of keys){
                const item=obj[key];
                if(checkIsObject(item) || Array.isArray(item)){
                    arr.push(...this.serailize(item,`${_key?_key+this.defaultSep:_key}${key}`));
                }else{
                    arr.push(`${_key?_key+this.defaultSep:_key}${key}`);
                }
            }
            return arr;
        }
        createTree(str){
            const arr=str.split(this.defaultSep);
            arr.reduce((key,name,index)=>{
                let id=!key?name:`${key}${this.defaultSep}${name}`,
                    details=this.createDetails(id,name,index != arr.length-1),
                    parentNode=!key?this.containerDom:this.findDetails(key);
                parentNode.appendChild(details);
                return id;
            },'')
        }
        createDetails(id,name,isdetails){
            if(this.findDetails(id)){
                return this.findDetails(id);
            }
            const details=document.createElement(isdetails?'details':'p');
            details.id=id;
            details.style.textIndent=id.split(this.defaultSep).length+'em';
            if(isdetails){
                const summary=document.createElement('summary');
                summary.innerHTML=`<input type="checkbox" value="${id}">${name}`;
                details.appendChild(summary);
            }else{
                details.innerHTML=`<input type="checkbox" value="${id}">${name}`;
            }
            this.detailsArr.push(details);
            return details;
        }
        findDetails(id){
            return this.detailsArr.filter(item=>item.id == id)[0];
        }
        addEvent() {
            this.containerDom.addEventListener('click',e=>{
                const target=e.target;
                if(target.tagName.toLowerCase() == 'input' && target.type == 'checkbox'){
                    if(target.parentNode.tagName.toLowerCase() == 'summary'){
                        const closestDetail=target.closest('details');
                        closestDetail.querySelectorAll('input[type="checkbox"]').forEach(function(item){
                            item.checked=target.checked;
                        });
                    }
                    this.showDom.innerHTML=this.findAllChecked();
                }
            },false)
        }
        findAllChecked(){
            return [...this.containerDom.querySelectorAll('p input[type="checkbox"]:checked')].map(function(item){
                return `<p>${item.value}</p>`;
            }).join('')
        }
    }

    const container=document.getElementById('container');
    const show=document.getElementById('show');
    const obj={
        a:{
            b:{
                c:1
            },
            e:{
                f:3
            }
        },
        d:1,
        f:[
            1,
            {g:{
                s:[1,2,3]
            }}
        ,3]
    }
    new CustomTree(obj,container,show);
</script>
</body>
</html>