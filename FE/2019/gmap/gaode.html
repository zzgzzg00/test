<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no,email=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta charset="utf-8">
    <title>Title</title>
    <style>
        *{
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }
        @-webkit-keyframes scale {
            0%{
                transform:scale(1);
            }
            100%{
                transform:scale(0.5);
            }
        }
        #container{
            width: 100vw;
            height: 100vh;
        }
        .info{
            color: red;
        }
        .point{
            font-size: 14px;
            width: 20px;
            height: 20px;
            text-align: center;
            line-height: 20px;
            border-radius: 50%;
            background-color: red;
            color: white;
        }
    </style>
</head>
<body>
<script src="../../common/JSXTransformer.js"></script>
<script src="../../common/react@16.8.5.js"></script>
<script src="../../common/react-dom@16.8.4.js"></script>
<script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.13&key=292a3ad1c60b7cd74c492c3272333bfa"></script>
<script type="text/jsx">
    const {useEffect}=React;
    let isScale=false;
    const useMap=()=>{
        const pos=[116.357652,40.042996]
        useEffect(()=>{
            const map = new AMap.Map('container',{
                zoom:6,
                center: [121.320205,31.193935],
//                layers: [
//                    new AMap.TileLayer.Satellite(),
//                    new AMap.TileLayer.RoadNet()
//                ],
//                zooms: [4,18],
                viewMode:'3D',
                resizeEnable: true
            });
            const path = [[121.320205,31.193935],[120.460118,31.597155],[119.955463,31.853511],[118.798537,31.968789],[118.319862,32.198885],[117.441495,32.901933],[117.250634,33.675657],[117.305076,34.267673],[116.891292,36.66893],[116.709066,39.509281],[116.378596,39.865208]];
            const name=['上海虹桥','无锡东','常州北','南京南','滁州','蚌埠南','宿州东','徐州东','济南西','廊坊','北京南'];

            const polyline = new AMap.Polyline({
                path : path,
                strokeColor:'red'
            })
            map.add(polyline);
            path.forEach((item,index)=>{
                const marker=new AMap.Marker({
                    position:item,
                    content:`<div class="point">${index}</div>`,
                    offset: new AMap.Pixel(0, 0)
                });
                marker.setLabel({
                    offset: new AMap.Pixel(0, 0),
                    content: `<div class='info'>${name[index]}站</div>`,
                    direction: 'right'
                });
                marker.on('click',function(){
                    map.setCenter(item);
                    if(!isScale){
                        map.setZoom(20);
                    }else{
                        map.setFitView();
                    }
                    isScale=!isScale;
                });
                map.add(marker);
            });
            let index=0;
            const len=path.length;
            setInterval(()=>{
//                map.setCenter(path[(++index)%len]);
//                map.setZoom(index*2);
            },10000);
            map.setFitView();
        },[]);
    }
    const App=props=>{
        useMap();
        return(
            <div id="container"></div>
        )
    }
    ReactDOM.render(<App/>,document.body);
</script>
</body>
</html>