<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<script>
    function run(gen){
        const it=gen();
        let m=0;
        function next(v){
            const {value,done}=it.next(v);
            if(!done){
                m+=value;
                next('!'+m);
            }
        }
        next();
    }
    function* test(){
        let x;
        for(let i=1;i<=3;i++){
            x=yield i;
            console.log(x);
        }
        x= x.replace('!','');
        if(x<=50){
            yield* test();
        }
    }
    run(test);

    function createGenerator(v,...funs){
        let state= 0,value= v,len=funs.length;
        return{
            next(x){
                if(state != 0){
                    value = x;
                }
                if(state >= len){
                    return{
                        done:true
                    }
                }
                return{
                    value:funs[state](value),
                    done:++state==len
                }
            }
        }
    }
    const funs=Array.from({length:4},(item,index)=>a=>a+index+'--');
    const gen=createGenerator(2,...funs);
    console.log(gen.next().value);
    console.log(gen.next(3).value);
    console.log(gen.next('1').value);
    console.log(gen.next('a').value);
    console.log(gen.next('b').done);
</script>
</body>
</html>