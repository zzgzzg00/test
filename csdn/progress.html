<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <style>
        div{
            height: 20px;
        }
        .outer{
            background-color: #e0e0e0;
            overflow: hidden;
        }
        .inner{
            background-color: #33cccc;
            background: linear-gradient(45deg,#33cccc 0%,#33cccc 50%,rgba(0,0,0,0) 0);
            width: 20%;
        }
    </style>
</head>
<body>
<div class="outer">
    <div class="inner" id="inner"></div>
</div>
<script>
    function ProgressBar(domId,speedController){
        this.interval=30;
        this.progress=0;
        this.timeHandle=null;
        this.dom=document.getElementById(domId);
        this.speendController=speedController||[{
            progress:100,
            interval:30
        }];
        this.controllerLength=this.speendController.length;
        this.rato=2;
        this.setRato();
    }
    ProgressBar.prototype.setRato=function(){
        var div=document.createElement('div');
        div.style.cssText='background: linear-gradient(45deg,#33cccc 0%,#33cccc 50%,rgba(0,0,0,0) 0);';
        document.body.appendChild(div);
        if(div.style.cssText.length<1){
            this.rato=1;
        }
        document.body.removeChild(div);
    }
    ProgressBar.prototype.finish=function(){
        this.stop();
        this.dom.style.width=this.progress+'%';
    }
    ProgressBar.prototype.stop=function(){
        this.progress=100*this.rato;
        if(this.timeHandle){
            window.clearTimeout(this.timeHandle);
        }
    }
    ProgressBar.prototype.setInterval=function(){
        for(var i=0;i<this.controllerLength;i++){
            var item=this.speendController[i];
            if(this.progress<=item.progress*this.rato){
                this.interval=item.interval;
                return;
            }
        }
    }
    ProgressBar.prototype.start=function(){
        var me=this;
        this.setInterval();
        if(this.progress<100*this.rato){
            this.dom.style.width=(++this.progress)+'%';
            this.timeHandle=window.setTimeout(function(){
                me.start();
            },me.interval)
        }else{
            this.stop();
        }
    }
    var p=new ProgressBar('inner',[{
        progress:10,
        interval:30
    },{
        progress:40,
        interval:60
    },{
        progress:80,
        interval:120
    },{
        progress:95,
        interval:240
    },{
        progress:100,
        interval:2400
    }]);
    p.start();
</script>
</body>
</html>