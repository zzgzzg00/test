<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<script>
    function test(obj){
        const v={};
        const f=function(key,va){
            if(!v[key]){
                v[key]=[];
            }
            v[key].push(va);
            if(v[key]['a']){
                va(v[key]['a'][0],v[key]['a'][1])
            }
        }
        const p=new Proxy(obj,{
            set(target,key,value){
                const r=Reflect.set(target,key,value);
                if(v[key]){
                    for(let i of v[key]){
                        i(key,value);
                    }
                    v[key]['a']=[key,value];
                }
                return r;
            },
            get(target,key){
                return Reflect.get(target,key);
            }
        });
        return {p,f};
    }
    const {p,f}=test({});
    f('a',(k,v)=>console.log(k,v));
    f('a',(k,v)=>console.log(k,v,2));
    p.a=1;
    f('a',(k,v)=>console.log(k,v,3));

    f('b',(k,v)=>console.log(k,v,4));
    f('b',(k,v)=>console.log(k,v,5));
    p.b=1;
    f('b',(k,v)=>console.log(k,v,6));
</script>
</body>
</html>