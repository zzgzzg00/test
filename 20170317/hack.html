<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta content="telephone=no" name="format-detection" />
    <meta name="apple-mobile-web-app-title" content="汽车票-qunar.com">
    <meta name="full-screen" content="yes"/>
    <meta name="browsermode" content="application"/>
    <meta name="x5-orientation" content="portrait"/>
    <meta name="x5-fullscreen" content="true"/>
    <meta name="x5-page-mode" content="app"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui" />
    <meta name="keywords" content="火车票,火车票查询,列车时刻表,火车票预定" />
    <meta name="description" content="去哪儿网(Qunar.com)火车票频道提供全国列车时刻表查询、火车票查询、火车票车次查询、火车票站站查询、高铁列车时刻表及价格查询。" />
    <style>
        *{
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            line-height: 1.5;
            text-decoration: none;
        }
        .invaild{
            box-shadow: 0 0 5px red inset;
        }
        :root{
            font-size: 100px;
            min-height: 100vh;
        }
        .hide{
            display: none;
        }
        .header{
            --bgcolor:#3cb0d0;
            height: .68rem;
            background-color: var(--bgcolor);
            width: 100%;
            display: flex;
            align-items:center;
            justify-content:center;
            --suggestheight:.34rem;
        }
        .header .suggest{
            position: relative;
            height: var(--suggestheight);
            font-size: 14px;
            background-color: #ffffff;
            line-height: var(--suggestheight);
            color: #888;
            font-size: 12px;
            padding-left: .1rem;
        }
        .header .suggest input{
            margin: 0 .1rem 0 .1rem;
            height: .22rem;
            font-size: 14px;
            border: none;
            outline: none;
        }
        .header .exchange{
            color: #fff;
            font-size: 14px;
            margin: 0 .2rem;
        }
        .header .citylist{
            position: absolute;
            top: .34rem;
            left: 0;
            right: 0;
            border: 1px solid var(--bgcolor);
            background-color: #ffffff;
            text-align: center;
            padding-bottom: .05rem;
            z-index: 10;
        }
        .header .citylist>p{
            padding-left: .05rem;
            font-size: 12px;
            line-height: .24rem;
            text-align: left;
        }
        .header .citylist>p.active{
            background-color: var(--bgcolor);
            color: #ffffff;
            cursor: pointer;
        }
        .header .citylist>a{
            margin-right: .05rem;
            padding: .02rem;
            color: #5d9cec;
        }
        .header .citylist>.disabled{
            color: #333;
        }
        .header .citylist>.error{
            color: #ff0000 !important;
        }
        .header .search{
            margin-left: .16rem;
            height: .36rem;
            line-height: .36rem;
            width: 1.12rem;
            background-color: #fc5830;
            color: #fff;
            font-size: 18px;
            outline: 0;
            border: 0;
            cursor: pointer;
            font-family: 'Microsoft YaHei';
        }
        .item{
            display: flex;
            font-size: 12px;
            border-bottom: 1px #e0e0e0 solid;
        }
        .item .icon{
            display: flex;
            align-items:center;
            justify-content:flex-end;
            width: .5rem;
            padding-right: .1rem;
        }
        .item .info{
            flex:1;
            align-items:center;
            justify-content:center;
            display: flex;
        }
        .item .price{
            width: 1rem;
            padding-right: .5rem;
            display: flex;
            align-items:center;
            justify-content:center;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="suggest" data-role="suggest">
            出发<input data-station="from" data-role="input" type="text" name="start" placeholder="请输入出发城市"/>
            <div data-role="citylist" class="citylist hide"></div>
        </div>
        <a href="#" class="exchange" action-type="exchange" tabindex="-1">一换一</a>
        <div class="suggest" data-role="suggest">
            到达<input data-station="to" data-role="input" type="text" name="end" placeholder="请输入到达城市"/>
            <div data-role="citylist" class="citylist hide"></div>
        </div>
        <input type="button" value="搜索" data-role="search" class="search" />
    </div>
    <div class="list">
        <div class="container">
            <div class="item">
                <div class="icon">123</div>
                <div class="info">
                    <div class="from">
                        <p class="time">14:41</p>
                        <p class="city">乌鲁木齐</p>
                    </div>
                    <div class="time">
                        <p class="usetime">1时55分</p>
                        <p>K9785</p>
                    </div>
                    <div class="to">
                        <p class="time">16:39</p>
                        <p class="city">石河子</p>
                    </div>
                </div>
                <div class="price">
                    <span>&yen;</span>11.5
                </div>
            </div>
        </div>
    </div>
    <script src="./Suggest.js"></script>
    <script>
    {
        const listUrl='';
        function throwError(str=''){
            throw new Error(str);
        }
        function initSuggest(){
            const suggests= [...document.querySelectorAll('[data-role="suggest"]')];
            //出发 到达用一个cache
            const cache= new SuggestCache();
            for(let suggest of suggests){
                new Suggest(suggest,{cache});
            }
        }
        function repeat(strArr,...params){
            const arr=[];
            for(let i of data){
                arr.push(String.raw(strArr, i.name, i.age));
            }
            return arr.join('');
        }
        function renderItem(data){
            let str=repeat`name=${1},age=${2}`;
            alert(str);
        }
        function renderList(data){

        }
        function bindEvents(){
            const suggetInput= [...document.querySelectorAll('[data-role="input"]')];
            const cityList= [...document.querySelectorAll('[data-role="citylist"]')];
            //换
            document.querySelector('[action-type="exchange"]').onclick=function(e){
                e.preventDefault();
                [suggetInput[1].value,suggetInput[0].value]= [...suggetInput.map(item=>item.value)];
            }
            document.querySelector(':root').onclick=function(){
                cityList.forEach(function(item,index){
                    if(!item.classList.contains('hide')){
                        let active=item.querySelector('.active');
                        if(!active.classList.contains('error')){
                            suggetInput[index].value=active.innerHTML;
                            suggetInput[index].parentNode.classList.remove('invaild');
                        }else{
                            suggetInput[index].value='';
                        }
                        item.classList.add('hide');
                    }
                });
            }
            document.querySelector('[data-role="search"]').onclick=function(e){
                const params=[];
                let flag=true;
                suggetInput.forEach(function(item){
                   if(!item.value){
                       item.parentNode.classList.add('invaild');
                       flag=false;
                       return false;
                   }
                   params.push(`${item.getAttribute('name')}=${item.value}`);
                });
                if(flag){
                    fetch(`${listUrl}?${params.join('&')}`)
                        .then(response=>response.json())
                        .then(data=>renderList(data));
                }
            }
        }

        function init(){
            initSuggest();
            bindEvents();

            let arr=Array.from({length:4},(item,index)=>({name:'x',age:index}));
            renderItem(arr);
        }
        init();
    }
    </script>
</body>
</html>