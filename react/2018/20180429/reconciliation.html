<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script src="../../common/JSXTransformer.js"></script>
<script src="../../common/react16.3.js"></script>
<script src="../../common/react-dom16.3.js"></script>
<script type="text/jsx">
    const {PureComponent}=React;
    class Test extends PureComponent{
        constructor(props){
            super(props);
        }
        componentDidMount(){
            console.log('remount');
        }
        render(){
            return(
                <span>{this.props.context}-{this.props.sign}</span>
            )
        }
    }
    /**
     * sign的改变导致Test的父组件类型发生变化 会引起Test的重新生成
     * 从而每次sign的改变都会使得Test执行componentDidMount
     * */
    class App extends PureComponent{
        constructor(props){
            super(props);
            this.state={
                sign:0,
                context:0
            }
            this.changeSignHandle=this.changeSignHandle.bind(this);
            this.changeContextHandle=this.changeContextHandle.bind(this);
        }
        changeSignHandle(){
            this.setState(preState=>({sign:preState.sign+1}));
        }
        changeContextHandle(){
            this.setState(preState=>({context:preState.context+1}));
        }
        render(){
            let con=''
            if(this.state.sign%2==0){
                con=<div><Test sign={this.state.sign} context={this.state.context}/></div>;
            }else{
                con=<p><Test sign={this.state.sign} context={this.state.context}/></p>
            }
            return(
                <div>
                    {con}
                    <span style={{marginRight:'10px'}} onClick={this.changeSignHandle}>sign</span>
                    <span onClick={this.changeContextHandle}>context</span>
                </div>
            )
        }
    }
    ReactDOM.render(<App />,document.body);
</script>
</body>
</html>