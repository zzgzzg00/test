<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script src="../../common/JSXTransformer.js"></script>
<script src="../../common/react16.3.js"></script>
<script src="../../common/react-dom16.3.js"></script>
<script type="text/jsx">
    /**
     * PureComponent
     *   对对象Object.keys之后比较A[key]===B[key]不再比较A[key]里的类型
     *
     * */

    /*
    function is(x,y){
        if (x === y) {
            return x !== 0 || y !== 0 || 1 / x === 1 / y;
        } else {
            return x !== x && y !== y;
        }
    }
    function shallowEqual(objA, objB) {
        if (is(objA, objB)) {
            return true;
        }

        if (typeof objA !== 'object' || objA === null ||
            typeof objB !== 'object' || objB === null) {
            return false;
        }

        const keysA = Object.keys(objA);
        const keysB = Object.keys(objB);

        if (keysA.length !== keysB.length) {
            return false;
        }
        for (let i = 0; i < keysA.length; i++) {
            if (
                !hasOwnProperty.call(objB, keysA[i]) ||
                !is(objA[keysA[i]], objB[keysA[i]])
            ) {
                return false;
            }
        }

        return true;
    }
    */
    const {Component,PureComponent}=React;
    class Show extends Component{
        constructor(props){
            super(props);
            this.state={
                item:[1,2,3]
            }
            this.change=this.change.bind(this);
        }
        shouldComponentUpdate(nextProps, nextState){
            return nextState.item != this.state.item;
        }
        change(){
            const {item}=this.state;
            item.push(7);
            this.setState({item});
        }
        render(){
            return(
                <div onClick={this.change}>show:{this.state.item.join('')}</div>
            )
        }
    }
    class PureShow extends PureComponent{
        constructor(props){
            super(props);
            this.state={
                item:[1,2,3]
            }
            this.change=this.change.bind(this);
        }
        change(){
            const {item}=this.state;
            item.push(7);
            this.setState({item});
        }
        render(){
            return(
                <div onClick={this.change}>pureshow:{this.state.item.join('')}</div>
            )
        }
    }
    const App=props=>(
        <React.Fragment>
            <Show />
            <PureShow />
        </React.Fragment>
    )
    ReactDOM.render(<App />,document.body);
</script>
</body>
</html>