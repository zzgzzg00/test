<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<script src="./common/react.js"></script>
<script src="./common/JSXTransformer.js"></script>
<script type="text/jsx">
    const {Component,PropTypes}=React;

    function addState(_Component,num){
        function* add(num){
            while(1){
                yield* [1,2,3,4].map(item=>`test${num+item}`);
            }
        }
        const iterator=add(num);
        return class extends Component{
            render(){
                return <_Component iterator={iterator} />
            }
        }
    }

    class Item extends Component{
        componentWillMount(){
            console.log(1);
        }
        render(){
            return <p>{this.props.item}</p>
        }
    }

    class Container extends Component{
        constructor(){
            super();
            this.state={
                test:''
            }
        }
        static get propTypes(){
            return {
                iterator:PropTypes.object,
                content:PropTypes.oneOfType([
                    PropTypes.object,
                    PropTypes.string
                ])
            }
        }
        static get defaultProps(){
            return {
                'content':'content'
            }
        }
        componentWillMount(){
            const me=this;
            this.setState({
                test:me.props.iterator.next().value
            });
        }
        clickHandle(){
            const test=this.props.iterator.next().value;
            this.setState({test})
        }
        renderItem(){
            return <Item item={this.state.test} />
        }
        renderContent(){
            return <p>{this.props.content}</p>
        }
        render(){
            return (
                <div onClick={this.clickHandle.bind(this)}>
                    {this.renderContent()}
                    {this.renderItem()}
                </div>
            )
        }
    }

    Container=addState(Container,0);

    React.render(<Container />,document.body);
</script>
</body>
</html>