<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style>
        @-webkit-keyframes show{
            0%{
                opacity: 0;
            }
            100%{
                opacity: 100;
            }
        }
        .show{
            -webkit-animation:show 2s ease-in 0s 1 forwards;
        }
    </style>
</head>
<body>
<div id="container"></div>
<script src="./common/JSXTransformer.js"></script>
<script src="./common/react15.js"></script>
<script src="./common/react-dom15.js"></script>
<script src="./common/redux.js"></script>
<script src="./common/react-redux.js"></script>
<script src="./common/react-router.js"></script>
<script type="text/jsx">
    const {Component,PropTypes}=React;
    const {combineReducers,createStore}=Redux;
    const {Provider,connect}=ReactRedux;
    const initState={
        styleObject:{
            color:'red'
        },
        color:'red',
        className:''
    }

    const styleObjectReduce=function(state={},action){
        const {type,color}=action;
        switch(type){
            case "change":
                return {color};
            default:
                return state;
        }
    }

    const colorReduce=function(state='',action){
        const {type,color}=action;
        switch(type){
            case "change":
                return color;
            default:
                return state;
        }
    }

    const classNameReduce=function(state='',action){
        const {type,className}=action;
        switch(type){
            case "changeClass":
                return className;
            default:
                return state;
        }
    }

    const reduce=combineReducers({
        styleObject:styleObjectReduce,
        color:colorReduce,
        className:classNameReduce
    });

    const store=createStore(reduce,initState);

    const changeAction=color=>({type:'change',color});

    const changeClassAction=className=>({type:'changeClass',className});

    const Test=(props)=>(
        <div style={props.styleObject} className={props.className}>
            <p>{props.color}</p>
            <button onClick={props.clickHandle} color={'blue'}>blue</button>
            <button onClick={props.clickHandle} color={'red'}>red</button>
            <button onClick={props.clickHandle} color={'yellow'}>yellow</button>
            <button onClick={props.fadeHandle}>fade</button>
        </div>
    );

    const stateMapToProps=(state)=>({
        styleObject:state.styleObject,
        color:state.color,
        className:state.className
    });

    const dispatchMapToProps=(dispatch)=>({
        clickHandle(e){
            const v=e.target.getAttribute('color');
            dispatch(changeAction(v));
        },
        fadeHandle(e){
            dispatch(changeClassAction('show'));
            window.setTimeout(()=>dispatch(changeClassAction('')),1000);
        }
    });

    const TestContainer=connect(stateMapToProps,dispatchMapToProps)(Test);

    const App=()=>(
        <Provider store={store}>
            <TestContainer />
        </Provider>
    )

    ReactDOM.render(<App />,document.getElementById('container'));
</script>
</body>
</html>