<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<script>
    /**
     * new 时 会修改bind 指定的this
     * 直接调用时this依旧是bind的this
     * */
    function Test(a){
        this.a=a;
    }
    var obj={
        'a':1
    }
    var T=Test.bind(obj);
    var t=new T('new');
    console.log(t.a,obj.a);//new 1
    T('T');
    console.log(obj.a);//T


    //bind实现
    if (!Function.prototype.bind) {
        Function.prototype.bind = function(oThis) {
            if (typeof this !== "function") {
                throw new TypeError(
                        "Function.prototype.bind - what is trying " +
                                "to be bound is not callable"
                );
            }
            var aArgs = Array.prototype.slice.call( arguments, 1 ),
                fToBind = this,
                fNOP = function(){},
                fBound = function(){
                    return fToBind.apply(
                            (
                                this instanceof fNOP &&
                                    oThis ? this : oThis
                            ),
                            aArgs.concat(
                                Array.prototype.slice.call( arguments )
                            )
                    );
                };
            fNOP.prototype = this.prototype;
            fBound.prototype = new fNOP();
            return fBound;
        };
    }

    if (!Function.prototype.softBind) {
        Function.prototype.softBind = function(obj) {
            var fn = this;
            var curried = [].slice.call( arguments, 1 );
            var bound = function() {
                return fn.apply(
                        (!this || this === (window || global)) ?
                                obj : this
                curried.concat.apply( curried, arguments )
                );
            };
            bound.prototype = Object.create( fn.prototype );
            return bound;
        };
    }
    function foo() {
        console.log("name: " + this.name);
    }
    var obj = { name: "obj" },
            obj2 = { name: "obj2" },
            obj3 = { name: "obj3" };
    var fooOBJ = foo.softBind( obj );
    fooOBJ(); // name: obj
    obj2.foo = foo.softBind(obj);
    obj2.foo(); // name: obj2 <---- 看！！！
    fooOBJ.call( obj3 ); // name: obj3 <---- 看！
    setTimeout( obj2.foo, 10 );
    // name: obj <---- 应用了软绑定

    var o1={},o2=Object.create(null);
    console.log(o1.constructor,o2.constructor);//function undefined

    {
        function foo(){
            console.log(this.a);
        }
        const a={
            a:'a',
            foo
        };
        const b={
            a:'b'
        }
        console.log(b.foo= a.foo)//返回 foo
    }
</script>
</body>
</html>